(this["webpackJsonpdestiny-power-bars"]=this["webpackJsonpdestiny-power-bars"]||[]).push([[2],{10:function(e,t,r){e.exports={details:"PowerDetails_details__1vqno",detailsRow:"PowerDetails_detailsRow__20lfp",detailsLabel:"PowerDetails_detailsLabel__2dvVG",detailsInlineIcon:"PowerDetails_detailsInlineIcon__1Pqe3",detailsValue:"PowerDetails_detailsValue__3daTt",progressBar:"PowerDetails_progressBar__2-GA8",progressBarFill:"PowerDetails_progressBarFill__sl9C7",progressBarOverlay:"PowerDetails_progressBarOverlay__1c66l"}},11:function(e,t,r){e.exports={characterDisplayWrapper:"CharacterDisplay_characterDisplayWrapper__1IXlj",dragOverlay:"CharacterDisplay_dragOverlay__2UjDt",dragOver:"CharacterDisplay_dragOver__1FVZx",dragging:"CharacterDisplay_dragging__37e2z",characterDisplay:"CharacterDisplay_characterDisplay__20O9A",header:"CharacterDisplay_header__2fx5d",emblemBackground:"CharacterDisplay_emblemBackground__2pAjE",emblemSecondarySpecial:"CharacterDisplay_emblemSecondarySpecial__15-aM",emblemSecondaryOverlay:"CharacterDisplay_emblemSecondaryOverlay__3IJk5",name:"CharacterDisplay_name__2j8PA",power:"CharacterDisplay_power__1p583",title:"CharacterDisplay_title__G1RAx",withTitle:"CharacterDisplay_withTitle__2QVYI",hasRedacted:"CharacterDisplay_hasRedacted__1jsLE",headerOverlayBar:"CharacterDisplay_headerOverlayBar__2pT62",content:"CharacterDisplay_content__263Ab"}},12:function(e,t,r){e.exports={membershipSelect:"MembershipSelect_membershipSelect__3GbZz",membership:"MembershipSelect_membership__3vKKK",membershipDisplayName:"MembershipSelect_membershipDisplayName__2jWVB",platform_xbox:"MembershipSelect_platform_xbox__1EgLN",platform_psn:"MembershipSelect_platform_psn__2ASN8",platform_steam:"MembershipSelect_platform_steam__3zG5m",platform_blizzard:"MembershipSelect_platform_blizzard__1zLDb",platform_stadia:"MembershipSelect_platform_stadia__2-ukT",crossSaveDisplayWrapper:"MembershipSelect_crossSaveDisplayWrapper__1AETV",crossSaveDisplay:"MembershipSelect_crossSaveDisplay__2ZNGP",crossSaveIcon:"MembershipSelect_crossSaveIcon__3jhZw",crossSaveMembershipIcon:"MembershipSelect_crossSaveMembershipIcon__1HLL-",crossSaveMembershipType_xbox:"MembershipSelect_crossSaveMembershipType_xbox__8gPas",crossSaveMembershipType_psn:"MembershipSelect_crossSaveMembershipType_psn__P61_o",crossSaveMembershipType_steam:"MembershipSelect_crossSaveMembershipType_steam__2roXt",crossSaveMembershipType_blizzard:"MembershipSelect_crossSaveMembershipType_blizzard__2qkhP",crossSaveMembershipType_stadia:"MembershipSelect_crossSaveMembershipType_stadia__2CnVB"}},14:function(e,t,r){e.exports={membershipHeader:"MembershipHeader_membershipHeader__31QBu",membershipSelect:"MembershipHeader_membershipSelect__1TdtJ",hardRefreshButton:"MembershipHeader_hardRefreshButton__2h0qG",hardRefreshIcon:"MembershipHeader_hardRefreshIcon__2JP-Z",hardRefreshText:"MembershipHeader_hardRefreshText__H4x6O",disabled:"MembershipHeader_disabled__3oW2P",logOutButton:"MembershipHeader_logOutButton__JG9_J",logOutIcon:"MembershipHeader_logOutIcon__2W360",logOutText:"MembershipHeader_logOutText__3TsqS"}},16:function(e,t,r){e.exports={powerBars:"PowerBars_powerBars__33tbb",powerRange:"PowerBars_powerRange__te0OD",rangeLine:"PowerBars_rangeLine__3sXeP",powerLabel:"PowerBars_powerLabel__z9Lm2",indicator:"PowerBars_indicator__1UcsC"}},18:function(e,t,r){e.exports={characterLinks:"CharacterLinks_characterLinks__1TWEL",content:"CharacterLinks_content__2v01s",link:"CharacterLinks_link__zfRay",linkText:"CharacterLinks_linkText__3ZLGm",link_tag_dim:"CharacterLinks_link_tag_dim__3F49B",link_tag_braytech:"CharacterLinks_link_tag_braytech__34k9M",link_tag_destinysets:"CharacterLinks_link_tag_destinysets__13QtP",link_tag_d2checklist:"CharacterLinks_link_tag_d2checklist__3rg2p",link_tag_guardianstats:"CharacterLinks_link_tag_guardianstats__MnZrG",link_tag_raidreport:"CharacterLinks_link_tag_raidreport__2W1oW",link_tag_dungeonreport:"CharacterLinks_link_tag_dungeonreport__1rvUg",hide:"CharacterLinks_hide__2jGa_"}},19:function(e,t,r){e.exports={interPowerBar:"InterPowerBar_interPowerBar__1irbI",min:"InterPowerBar_min__nPrv5",max:"InterPowerBar_max__23K0g",bar:"InterPowerBar_bar__1z25i",fillBar:"InterPowerBar_fillBar__2bwYr",extraFillBar:"InterPowerBar_extraFillBar__2RPo3",barOverlay:"InterPowerBar_barOverlay___zQVM"}},20:function(e,t,r){e.exports={anchor:"LoadingSpinner_anchor__78Pnm",spinner:"LoadingSpinner_spinner__32tWn",spin:"LoadingSpinner_spin__3FVoi",loading:"LoadingSpinner_loading__3Y_gu",spinnerLarge:"LoadingSpinner_spinnerLarge__KooL0",spinnerLargeDouble:"LoadingSpinner_spinnerLargeDouble__pi4h9",spinnerSmall:"LoadingSpinner_spinnerSmall__27lWl",spinnerSmallDouble:"LoadingSpinner_spinnerSmallDouble__2FOGm",status:"LoadingSpinner_status__3sgCR"}},200:function(e,t,r){},201:function(e,t,r){"use strict";r.r(t);var a={};r.r(a),r.d(a,"default",(function(){return K}));var n={};r.r(n),r.d(n,"BungieSystemDisabledError",(function(){return Q})),r.d(n,"bungieAuthedFetch",(function(){return Z})),r.d(n,"clearStoredManifest",(function(){return ne})),r.d(n,"getManifest",(function(){return ce})),r.d(n,"getBasicProfile",(function(){return ie})),r.d(n,"getFullProfile",(function(){return se})),r.d(n,"setItemLockState",(function(){return oe}));var c={};r.r(c),r.d(c,"hasManuallyAuthed",(function(){return _e})),r.d(c,"getAuthUrl",(function(){return Oe})),r.d(c,"manualStartAuth",(function(){return we})),r.d(c,"getAccessToken",(function(){return Ee})),r.d(c,"hasValidAuth",(function(){return De})),r.d(c,"getDestinyMemberships",(function(){return Te})),r.d(c,"hasDestinyMemberships",(function(){return Pe})),r.d(c,"getSelectedDestinyMembership",(function(){return Ce})),r.d(c,"hasSelectedDestinyMembership",(function(){return Re})),r.d(c,"setSelectedDestinyMembership",(function(){return Me})),r.d(c,"auth",(function(){return Be})),r.d(c,"logOut",(function(){return He}));var i={};r.r(i),r.d(i,"loadCharacterDisplayOrder",(function(){return Zr})),r.d(i,"saveCharacterDisplayOrder",(function(){return Xr})),r.d(i,"getPower",(function(){return ra})),r.d(i,"getCachedCharacterData",(function(){return la})),r.d(i,"getIsFetchingCharacterData",(function(){return da})),r.d(i,"bustProfileCache",(function(){return pa})),r.d(i,"getCharacterData",(function(){return ha}));var s={};r.r(s),r.d(s,"VENDOR_ENGRAMS_DROP_NO_DATA",(function(){return ba})),r.d(s,"VENDOR_ENGRAMS_DROP_LOW",(function(){return ma})),r.d(s,"VENDOR_ENGRAMS_DROP_HIGH",(function(){return fa})),r.d(s,"getVendorDisplayName",(function(){return va})),r.d(s,"getVendorEngramsData",(function(){return Oa}));var o=r(0),l=r(1),u=r(85),d=r.n(u),p=r(4),h=r(3),b=r(17),m=r(2),f=r.n(m),j=r(5),v=r(86),_=r(6),O=r.n(_),g=r(33),x=r.n(g),w=r(205),y=r(48),S=r(7),A=r(46),I=r(87),E=r(94),N=r(95),k=r(204),D=r(50),T="https://www.bungie.net/platform/app/oauth/token/",P=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_NPM_PACKAGE_GITHEAD:"acea3b8c34aa4b202ed41e4607c024a72290da8e",REACT_APP_BUNGIE_API_KEY:"d216f4575ce8407781070ce5579340ae",REACT_APP_BUNGIE_OAUTH_CLIENT_ID:"31116",REACT_APP_BUNGIE_OAUTH_CLIENT_SECRET:"TgX91i4g22hBjysd4tffoiOoZRbkox5xH0p2x7mSC4I"}),C=P.REACT_APP_BUNGIE_API_KEY,R=P.REACT_APP_BUNGIE_OAUTH_CLIENT_ID,M=P.REACT_APP_BUNGIE_OAUTH_CLIENT_SECRET;if(!C||!R||!M)throw Error("React env vars must be provided");var B=C,H=R,L=M;var F,U=r(88);!function(e){e.GET_MANIFEST="GET_MANIFEST",e.LOAD_MANIFEST_DATA="LOAD_MANIFEST_DATA",e.FETCH_MANIFEST_DATA="FETCH_MANIFEST_DATA",e.PARSE_MANIFEST_DATA="PARSE_MANIFEST_DATA",e.STORE_MANIFEST_DATA="STORE_MANIFEST_DATA",e.MANIFEST_DATA_READY="MANIFEST_DATA_READY",e.MANIFEST_FETCH_ERROR="MANIFEST_FETCH_ERROR",e.UNAUTHED_FETCH_ERROR="UNAUTHED_FETCH_ERROR",e.FETCHING_CHARACTER_DATA_CHANGE="FETCHING_CHARACTER_DATA_CHANGE",e.LOG_OUT="LOG_OUT"}(F||(F={}));var G=new U.EventEmitter,W=G;function V(e,t){var r=Object(l.useRef)();Object(l.useEffect)((function(){r.current=t}),[t]),Object(l.useEffect)((function(){var t=function(e){var t;return null===(t=r.current)||void 0===t?void 0:t.call(r,e)};return G.addListener(e,t),function(){G.removeListener(e,t)}}),[e])}var z=r(93).a;z.initialize("UA-149614480-1",{}),z.set({anonymizeIp:!0}),z.pageview(window.location.pathname+window.location.search);var q,J,Y,K=z,Q=function(e){Object(I.a)(r,e);var t=Object(E.a)(r);function r(){return Object(A.a)(this,r),t.call(this,"Bungie API disabled")}return r}(Object(N.a)(Error)),Z=function(){var e=Object(j.a)(f.a.mark((function e(t){var r,a,n,c,i,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ee(),a={"x-api-key":B},r&&(a.Authorization="Bearer ".concat(r)),n="".concat(t.url).concat(t.params?"?"+Object.entries(t.params).map((function(e){var t=Object(p.a)(e,2),r=t[0],a=t[1];return"".concat(encodeURIComponent(r),"=").concat(encodeURIComponent(a))})):""),c={method:t.method,headers:a,credentials:"include"},t.body&&(c.body=JSON.stringify(t.body)),e.next=8,fetch(n,c);case 8:if(200===(i=e.sent).status){e.next=23;break}if(401===i.status&&W.emit(F.UNAUTHED_FETCH_ERROR),503!==i.status){e.next=22;break}return e.prev=12,e.next=15,i.json();case 15:if(!(s=e.sent)||"SystemDisabled"!==s.ErrorStatus){e.next=18;break}throw new Q;case 18:e.next=22;break;case 20:e.prev=20,e.t0=e.catch(12);case 22:throw Error(i.status.toString());case 23:return e.next=25,i.json();case 25:return e.abrupt("return",e.sent);case 26:case"end":return e.stop()}}),e,null,[[12,20]])})));return function(t){return e.apply(this,arguments)}}(),X="MANIFEST_VERSION",$="MANIFEST_DATA",ee=["DestinyInventoryItemDefinition","DestinyVendorDefinition","DestinyRecordDefinition"],te=function(){var e=Object(j.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q||(q=Object(j.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Object(D.b)($);case 3:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))()),e.abrupt("return",q);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=/^[a-z]{2}$/,t=new URLSearchParams(window.location.search),r=t.get("lang");if(r&&e.test(r))return r;var a,n=t.get("useLang")||"";if((a=n)&&"true"===a.toLowerCase()&&navigator&&navigator.language){var c=navigator.language.substr(0,2);if(e.test(c))return c}},ae=function(){var e=Object(j.a)(f.a.mark((function e(t){var r,a,n,c,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}throw Error("No manifest!");case 3:return r=t.version,W.emit(F.FETCH_MANIFEST_DATA),a=re()||"en",n=t.jsonWorldComponentContentPaths[a]||t.jsonWorldComponentContentPaths.en,e.next=9,Promise.all(ee.map((function(e){return fetch("https://www.bungie.net".concat(n[e])).then((function(e){return e.json()}))})));case 9:return c=e.sent,i=ee.reduce((function(e,t,r){return Object(S.a)(Object(S.a)({},e),{},Object(h.a)({},t,c[r]))}),{}),console.log(i),W.emit(F.PARSE_MANIFEST_DATA),Object.keys(i).forEach((function(e){ee.includes(e)||delete i[e]})),W.emit(F.STORE_MANIFEST_DATA),e.next=17,Object(D.c)($,i);case 17:return localStorage.setItem(X,r),e.abrupt("return",i);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(j.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem(X),e.next=3,Object(D.a)($);case 3:Y=void 0,W.emit(F.MANIFEST_FETCH_ERROR);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();window.clearDestinyManifest=function(){return ne().then((function(){return console.log("Cleared Destiny manifest")}))};var ce=function(){var e=Object(j.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Y||(Y=Promise.resolve().then(Object(j.a)(f.a.mark((function e(){var t,r,a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=te(),K.event({category:"Data",action:"Attempt load manifest",nonInteraction:!0}),W.emit(F.GET_MANIFEST),e.next=5,Object(k.a)(Z);case 5:if(r=e.sent,a=localStorage.getItem(X),!r||!r.Response||r.Response.version!==a||window.location.search.includes("updateManifest")){e.next=15;break}if(J){e.next=13;break}return W.emit(F.LOAD_MANIFEST_DATA),e.next=12,t;case 12:J=e.sent;case 13:if(!J||!ee.every((function(e){return J&&!!J[e]}))){e.next=15;break}return e.abrupt("return",{manifest:J});case 15:if(!r||!r.ErrorStatus||"Success"===r.ErrorStatus){e.next=20;break}if(K.event({category:"Errors",action:'Error status "'.concat(r.ErrorStatus,'" returned from manifest request'),nonInteraction:!0}),"SystemDisabled"!==r.ErrorStatus){e.next=19;break}return e.abrupt("return",{manifest:null,error:new Q});case 19:return e.abrupt("return",{manifest:null,error:Error('Error status "'.concat(r.ErrorStatus,'" returned from manifest request'))});case 20:if(r&&r.Response){e.next=22;break}throw Error("No manifest received!");case 22:return J=void 0,K.event({category:"Data",action:"Fetch remote manifest",nonInteraction:!0}),e.next=26,ae(r.Response);case 26:return n=e.sent,J=n,e.abrupt("return",{manifest:n});case 29:case"end":return e.stop()}}),e)})))).then((function(e){if(e.manifest&&!e.error)return W.emit(F.MANIFEST_DATA_READY),e;throw e.error})).catch((function(e){return console.error(e),W.emit(F.MANIFEST_FETCH_ERROR),Y=void 0,{manifest:null,error:e}}))),e.abrupt("return",Y);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ie=function(e,t){return K.event({category:"Character Data",action:"Fetch minimal profile",nonInteraction:!0}),Object(k.b)(Z,{components:[200,205],destinyMembershipId:t,membershipType:e})},se=function(e,t){return K.event({category:"Character Data",action:"Fetch full profile",nonInteraction:!0}),Object(k.b)(Z,{components:[200,201,205,102,300,104],destinyMembershipId:t,membershipType:e})},oe=function(e){return Object(k.c)(Z,e)},le="bungieAccessToken",ue="bungieAccessTokenExpiryTime",de="bungieRefreshToken",pe="bungieRefreshTokenExpiryTime",he="bungieMembershipId",be="destinyMemberships",me="destinyMembership",fe="manualAuthed";W.on(F.UNAUTHED_FETCH_ERROR,(function(){localStorage.removeItem(le)}));var je,ve=function(){localStorage.removeItem(le),localStorage.removeItem(ue),localStorage.removeItem(de),localStorage.removeItem(pe),localStorage.removeItem(he),localStorage.removeItem(be)},_e=function(){return!!localStorage.getItem(fe)},Oe=function(){return"".concat("https://www.bungie.net/en/OAuth/Authorize","?").concat(Object(y.stringify)({response_type:"code",client_id:H,client_secret:L}))},ge=!1,xe=function(){ve(),K.event({category:"Auth",action:"Redirect for Bungie authentication",nonInteraction:!0});try{if(ge)throw Error("Re-navigation attempt");window.location.assign(Oe()),ge=!0}catch(e){console.error(e)}},we=function(){localStorage.setItem(fe,"TRUE"),xe()},ye=function(e){if(1===e.length)return Me(e[0]),e[0];var t=e.filter((function(e){return e.crossSaveOverride===e.membershipType})),r=e.filter((function(e){return 0===e.crossSaveOverride}));return 1===t.length&&0===r.length?(Me(t[0]),t[0]):void 0},Se=function(){var e=Object(j.a)(f.a.mark((function e(t){var r,a,n,c,i,s,o,l,u,d,p;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=31;break}return e.next=4,t.json();case 4:return r=e.sent,a=r.access_token,n=r.expires_in,c=Date.now()+1e3*n,i=r.refresh_token,s=r.refresh_expires_in,o=Date.now()+1e3*s,l=r.membership_id,localStorage.setItem(le,a),localStorage.setItem(ue,c.toString()),localStorage.setItem(de,i),localStorage.setItem(pe,o.toString()),localStorage.setItem(he,l),e.next=19,Object(w.a)(Z,{membershipId:l,membershipType:254});case 19:if((u=e.sent)&&u.Response&&(!u.ErrorStatus||"Success"===u.ErrorStatus)){e.next=23;break}return K.event({category:"Errors",action:"Destiny membership fetch error, status: ".concat(u.ErrorStatus),nonInteraction:!0}),e.abrupt("return",{authSuccess:!1,error:"Status code ".concat(u.ErrorStatus," from memberships endpoint")});case 23:return d=u.Response.destinyMemberships,localStorage.setItem(be,JSON.stringify(d)),(p=Ce())&&!d.some((function(e){return e.membershipId===p.membershipId}))&&localStorage.removeItem(me),ye(d),e.abrupt("return",{accessToken:a,authSuccess:!0});case 31:if(200===t.status){e.next=34;break}return K.event({category:"Auth",action:"Status code ".concat(t.status," from authentication request"),nonInteraction:!0}),e.abrupt("return",{authSuccess:!1,error:"Status code ".concat(t.status," from authentication request")});case 34:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ae=function(){var e=Object(j.a)(f.a.mark((function e(t){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K.event({category:"Auth",action:"Oauth token request",nonInteraction:!0}),e.next=5,fetch(T,{body:Object(y.stringify)({grant_type:"authorization_code",code:t,client_id:H,client_secret:L}),cache:"no-cache",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",redirect:"follow",referrer:"no-referrer"});case 5:return r=e.sent,e.next=8,Se(r);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ie=function(){var e=Object(j.a)(f.a.mark((function e(){var t,r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem(de),K.event({category:"Auth",action:"Oauth token refresh",nonInteraction:!0}),e.next=6,fetch(T,{body:Object(y.stringify)({grant_type:"refresh_token",refresh_token:t,client_id:H,client_secret:L}),cache:"no-cache",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",redirect:"follow",referrer:"no-referrer"});case 6:return r=e.sent,e.next=9,Se(r);case 9:return(a=e.sent)&&a.authSuccess||ve(),e.abrupt("return",a);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ee=function(){return localStorage.getItem(le)},Ne=function(){var e=Ee(),t=parseInt(localStorage.getItem(ue)||"-1",10);return e&&t>Date.now()},ke=function(){var e=localStorage.getItem(de),t=parseInt(localStorage.getItem(pe)||"-1",10);return e&&t>Date.now()},De=function(){var e=Ne(),t=localStorage.getItem(he),r=Te();return!!(e&&t&&r)},Te=function(){var e=localStorage.getItem(be);try{if(e)return JSON.parse(e)}catch(t){K.event({category:"Data",action:"Error loading destiny memberships from local storage",nonInteraction:!0}),console.error("Error loading destiny memberships",t.message)}},Pe=function(){return!!Te()},Ce=function(){var e=localStorage.getItem(me);try{if(e)return JSON.parse(e);var t=Te();if(t)return ye(t)}catch(r){K.event({category:"Data",action:"Error loading destiny membership from local storage",nonInteraction:!0}),console.error("Error loading destiny membership",r.message)}},Re=function(){return!!Ce()},Me=function(e){localStorage.setItem(me,JSON.stringify(e))},Be=function(){var e=Object(j.a)(f.a.mark((function e(){var t,r,a,n,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new URLSearchParams(window.location.search),!(r=t.get("code"))||De()){e.next=11;break}return e.next=7,Ae(r);case 7:if(!(a=e.sent)||!1!==(null===a||void 0===a?void 0:a.authSuccess)){e.next=11;break}return console.error(a.error),e.abrupt("return",!1);case 11:if(r&&window.history.replaceState({},document.title,"".concat(window.location.origin).concat(window.location.pathname)),!De()||!Pe()){e.next=14;break}return e.abrupt("return",!0);case 14:if(n=Ne(),c=ke(),n||!c){e.next=20;break}return e.next=19,Ie();case 19:return e.abrupt("return",Be());case 20:return _e()&&xe(),e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),He=function(){var e=Object(j.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem(fe),ve(),W.emit(F.LOG_OUT);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Le=r(11),Fe=r.n(Le),Ue=r(18),Ge=r.n(Ue),We=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.text,a=t.tags,n=void 0===a?[]:a,c=r||new URL(e).hostname;return Object(o.jsx)("li",{children:Object(o.jsx)("a",{href:e,target:"_blank",rel:"noopener",className:O.a.apply(void 0,Object(b.a)(n.map((function(e){return Ge.a["link_tag_".concat(e)]})))),children:Object(o.jsx)("span",{className:Ge.a.linkText,children:c})})})},Ve={1:"xb",2:"ps",3:"pc",4:"pc",5:"stadia"},ze=function(e){var t=e.membershipType,r=e.membershipId,a=e.characterId,n=e.onImageExportClick,c=Object(l.useState)(!1),i=Object(p.a)(c,2),s=i[0],u=i[1];return Object(o.jsx)("div",{className:O()(Ge.a.characterLinks,Object(h.a)({},Ge.a.hide,s)),children:Object(o.jsx)("div",{className:Ge.a.content,children:Object(o.jsxs)("ul",{children:[We("https://www.destinyitemmanager.com",{text:"Destiny Item Manager",tags:["dim"]}),We("https://braytech.org/".concat(t,"/").concat(r,"/").concat(a,"/now"),{text:"Braytech",tags:["braytech"]}),We("https://destinysets.com/",{text:"Destiny Sets",tags:["destinysets"]}),We("https://www.d2checklist.com/".concat(t,"/").concat(r,"/milestones"),{text:"D2 Checklist",tags:["d2checklist"]}),We("https://guardianstats.com/profile/".concat(r),{text:"Guardianstats",tags:["guardianstats"]}),We("https://raid.report/".concat(Ve[t],"/").concat(r),{text:"Raid Report",tags:["raidreport"]}),We("https://dungeon.report/".concat(Ve[t],"/").concat(r),{text:"Dungeon Report",tags:["dungeonreport"]}),n&&Object(o.jsx)("li",{children:Object(o.jsx)("span",{className:Ge.a.link,onClick:Object(j.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.next=3,n();case 3:u(!1);case 4:case"end":return e.stop()}}),e)}))),children:Object(o.jsx)("span",{className:Ge.a.linkText,children:"Export image"})})})]})})})},qe="kinetic",Je="energy",Ye="power",Ke="head",Qe="gloves",Ze="chest",Xe="legs",$e="classItem",et=(je={},Object(h.a)(je,qe,1498876634),Object(h.a)(je,Je,2465295065),Object(h.a)(je,Ye,953998645),Object(h.a)(je,Ke,3448274439),Object(h.a)(je,Qe,3551918588),Object(h.a)(je,Ze,14239492),Object(h.a)(je,Xe,20886954),Object(h.a)(je,$e,1585787867),je),tt=Object.entries(et).reduce((function(e,t){var r=Object(p.a)(t,2),a=r[0],n=r[1];return Object(S.a)(Object(S.a)({},e),{},Object(h.a)({},n,a))}),{}),rt=[].concat([qe,Je,Ye],[Ke,Qe,Ze,Xe,$e]),at=2,nt=3,ct=["titan","hunter","warlock"],it=1200,st=1250,ot=1260,lt=function(e){return!!(e.state&&4&e.state)},ut=r(9),dt=r.n(ut),pt=function(e){var t,r=e.min,a=e.max,n=e.value,c=e.avgValue,i=e.label,s=e.icon,l=e.isMasterworked,u=e.itemName,d=e.location,p=e.isEquipped,b=a-r,m=Math.floor((n-r)/b*1e3)/10,f=Math.floor((c-r)/b*1e3)/10,j="".concat(n," ").concat(i),v=function(e,t){switch(e){case 0:return;case 1:return t?"Equipped":"Inventory";case 2:return"Vault";case 3:return"Vendor";case 4:return"Postmaster";default:return}}(d,p),_="".concat(u).concat(v?" (".concat(v,")"):""),g=Object(o.jsxs)("span",{className:dt.a.label,children:[Object(o.jsx)("span",{className:O()(dt.a.power,(t={},Object(h.a)(t,dt.a.max,n>=a),Object(h.a)(t,dt.a.belowAverage,n<c),t)),children:n}),Object(o.jsxs)("span",{className:dt.a.slotName,children:[Object(o.jsx)("span",{className:dt.a.generalLabel,children:i}),Object(o.jsx)("span",{className:dt.a.specificLabel,children:_})]})]});return Object(o.jsxs)("div",{className:dt.a.barWrapper,children:[Object(o.jsxs)("div",{className:dt.a.iconWrapper,title:_,children:[s?Object(o.jsx)("img",{className:dt.a.icon,src:"https://www.bungie.net".concat(s),alt:j}):null,s&&2===d?Object(o.jsx)("div",{className:dt.a.vaultOverlay}):null,s&&4===d?Object(o.jsx)("div",{className:dt.a.postmasterOverlay}):null,s&&l?Object(o.jsx)("div",{className:dt.a.masterworkOverlay}):null]}),Object(o.jsxs)("div",{className:dt.a.barContainer,children:[Object(o.jsx)("div",{className:dt.a.filledBar,style:{width:"".concat(m,"%")},children:g}),Object(o.jsx)("div",{className:dt.a.barLine,style:{left:"".concat(f,"%")}})]})]})},ht=r(16),bt=r.n(ht),mt={hunter:"Hunter Cloak",titan:"Titan Mark",warlock:"Warlock Bond"},ft=function(e){var t=e.useUnrestrictedPower&&e.unrestrictedOverallPowerExact&&e.unrestrictedOverallPowerExact>e.overallPowerExact?e.topUnrestrictedItemBySlot:e.topItemBySlot,r=rt.reduce((function(r,a){var n,c,i;return Object(S.a)(Object(S.a)({},r),{},Object(h.a)({},a,(null===t||void 0===t||null===(n=t[a])||void 0===n||null===(c=n.instanceData)||void 0===c||null===(i=c.primaryStat)||void 0===i?void 0:i.value)||e.overallPower))}),{}),a=Math.floor(e.overallPower),n=Math.min.apply(Math,Object(b.a)(Object.values(r))),c=Math.max(50*Math.floor(n/50)-50,0),i=Math.max.apply(Math,Object(b.a)(Object.values(r))),s=st-i<50?10:50,l=Math.ceil(i/s)*s,u=l-c,d=Math.floor((a-c)/u*1e3)/10;return Object(o.jsxs)("div",{className:bt.a.powerBars,children:[Object(o.jsxs)("div",{className:bt.a.powerRange,children:[Object(o.jsx)("div",{className:bt.a.minPower,children:c}),Object(o.jsx)("div",{className:bt.a.rangeLine}),Object(o.jsx)("div",{className:bt.a.maxPower,children:l})]}),Object(o.jsx)("div",{className:bt.a.bars,children:Object.entries(r).map((function(r){var n,i,s,u,d=Object(p.a)(r,2),h=d[0],b=d[1],m=null===t||void 0===t?void 0:t[h];return Object(o.jsx)(pt,{min:c,max:l,value:b,avgValue:a,label:(u=e.className,{chest:"Chest Armor",classItem:mt[u],energy:"Energy Weapon",gloves:"Gauntlets",head:"Helmet",kinetic:"Kinetic Weapon",legs:"Leg Armor",power:"Power Weapon"})[h]||h,icon:null===m||void 0===m||null===(n=m.itemDefinition)||void 0===n?void 0:n.displayProperties.icon,isMasterworked:m&&lt(m),itemName:null===m||void 0===m||null===(i=m.itemDefinition)||void 0===i?void 0:i.displayProperties.name,location:null===m||void 0===m?void 0:m.location,isEquipped:null===m||void 0===m||null===(s=m.instanceData)||void 0===s?void 0:s.isEquipped},"".concat(e.character.characterId,"_").concat(h))}))}),Object(o.jsx)("div",{className:bt.a.powerLabel,children:Object(o.jsx)("div",{className:bt.a.indicator,style:{left:"".concat(d,"%")},children:a})})]})},jt=r(10),vt=r.n(jt),_t=r(19),Ot=r.n(_t),gt=function(e){var t=e.value,r=e.extraValue,a=r&&r>t?r:t,n=Math.floor(a),c=a===n?a+1:Math.ceil(a);n===ot&&a===n&&(c=n,n-=1);var i=Math.max(0,Math.floor(100*t-100*n)),s=r?Math.floor(100*r-100*n):void 0;return Object(o.jsxs)("div",{className:Ot.a.interPowerBar,children:[Object(o.jsx)("div",{className:Ot.a.min,children:n}),Object(o.jsxs)("div",{className:Ot.a.bar,children:[r?Object(o.jsx)("div",{className:Ot.a.extraFillBar,style:{width:"".concat(s,"%")}}):null,Object(o.jsx)("div",{className:Ot.a.fillBar,style:{width:"".concat(i,"%")}}),Object(o.jsx)("div",{className:Ot.a.barOverlay})]}),Object(o.jsx)("div",{className:Ot.a.max,children:c})]})},xt=r(89),wt=r.n(xt),yt=function(e){return e>=0?"+".concat(e):"".concat(e)},St=function(e){var t=e.children,r=e.withSign,a=void 0!==r&&r;return Object(o.jsx)("span",{className:wt.a.inlinePowerNumber,children:a?yt(t):t})},At=function(e){var t=e.value,r=e.max;if(void 0===t||void 0===r)return null;var a=Math.floor(t/r*1e3)/10,n=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")};return Object(o.jsxs)("div",{className:vt.a.progressBar,title:"".concat(n(t)," / ").concat(n(r)),children:[Object(o.jsx)("div",{className:vt.a.progressBarFill,style:{width:"".concat(a,"%")}}),Object(o.jsx)("div",{className:vt.a.progressBarOverlay})]})},It=function(e){var t=e.overallPowerExact,r=e.overallPower,a=e.artifactData,n=e.unrestrictedOverallPower,c=e.unrestrictedOverallPowerExact,i=e.useUnrestrictedPower,s=void 0===i||i,l=s&&n||r;return a&&0!==a.bonusPower?Object(o.jsxs)("div",{className:vt.a.details,children:[Object(o.jsxs)("div",{className:vt.a.detailsRow,children:[Object(o.jsxs)("div",{className:vt.a.detailsLabel,children:[s&&n&&n>r?"Maximum gear power (with exotics)":"Maximum equippable gear power",":"]}),Object(o.jsx)("div",{className:vt.a.detailsValue,children:Object(o.jsx)(St,{children:l})})]}),Object(o.jsx)("div",{className:vt.a.detailsRow,children:Object(o.jsx)(gt,{value:t,extraValue:s?c:void 0})}),a?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("div",{className:vt.a.detailsRow,children:[Object(o.jsxs)("div",{className:vt.a.detailsLabel,children:[Object(o.jsx)("img",{className:vt.a.detailsInlineIcon,src:"https://www.bungie.net".concat(a.iconPath),alt:""}),a.name," bonus power:"]}),Object(o.jsx)("div",{className:vt.a.detailsValue,children:Object(o.jsx)(St,{withSign:!0,children:a.bonusPower})})]}),Object(o.jsx)("div",{className:vt.a.detailsRow,children:Object(o.jsx)(At,{value:a.progressToNextLevel,max:a.nextLevelAt})})]}):null]}):Object(o.jsx)("div",{className:vt.a.details,children:Object(o.jsx)("div",{className:vt.a.detailsRow,children:Object(o.jsx)(gt,{value:t})})})},Et=r(8),Nt=r.n(Et),kt=function(e){var t=e.overallPowerExact,r=e.overallPower,a=e.unrestrictedOverallPowerExact,n=e.unrestrictedOverallPower,c=e.potentialOverallPower,i=e.useUnrestrictedPower,s=void 0===i||i,l=e.onChangeUseUnrestrictedPower,u=void 0===l?function(){}:l,d=a||t,p=n||r;c=c||Math.min(it,p);var h=8*((d===p?p+1:Math.ceil(d))-d),b=8*(c-d),m=ot-p>1?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(St,{children:Math.min(p+1,ot)})," ","or"," ",Object(o.jsx)(St,{children:Math.min(p+2,ot)})]}):Object(o.jsx)(St,{children:Math.min(p+2,ot)});return Object(o.jsxs)("div",{className:Nt.a.hints,children:[c&&c>p&&p>st&&Object(o.jsxs)("div",{className:O()(Nt.a.hint,Nt.a.dropHint,Nt.a.legendaryWorldDropHint),children:[Object(o.jsxs)("span",{children:["Powerful rewards can increase your overall gear power to"," ",Object(o.jsx)(St,{children:c})]}),Object(o.jsx)("div",{className:Nt.a.hintExtra,children:Object(o.jsxs)("div",{className:Nt.a.hintExtraInner,children:[Object(o.jsxs)("div",{children:["Powerful rewards from milestones or prime engrams can drop with a power level up to ",Object(o.jsx)(St,{children:p})," for this character."]}),Object(o.jsx)("div",{children:"Replacing items which are below your current overall power can increase your power to a higher average."}),p<ot&&Object(o.jsx)("div",{children:"Raising your overall power before collecting your next pinnacle reward will give you the most efficient progress."}),h&&h!==b&&Object(o.jsxs)("div",{children:["You need an extra"," ",Object(o.jsx)(St,{children:h})," total power on your items to reach an overall power of"," ",Object(o.jsx)(St,{children:Math.floor(p+1)}),"."]}),b&&Object(o.jsxs)("div",{children:["You need an extra"," ",Object(o.jsx)(St,{children:b})," total power on your items to reach an overall power of"," ",Object(o.jsx)(St,{children:c}),"."]})]})})]}),c>p&&p<=st&&Object(o.jsxs)("div",{className:O()(Nt.a.hint,Nt.a.dropHint,Nt.a.worldDropHint),children:[Object(o.jsxs)("span",{children:["World drops can increase your overall gear power to"," ",Object(o.jsx)(St,{children:c})]}),Object(o.jsx)("div",{className:Nt.a.hintExtra,children:Object(o.jsxs)("div",{className:Nt.a.hintExtraInner,children:[Object(o.jsxs)("div",{children:["World drops (from strikes, public events,"," ",p<=st&&"vendors, ","non-powerful rewards) can drop with a power level"," ",p>=it?Object(o.jsxs)(o.Fragment,{children:["from ",Object(o.jsx)(St,{children:p-3})," to"," ",Object(o.jsx)(St,{children:p})]}):Object(o.jsxs)(o.Fragment,{children:["above your current power, increasing your power incrementally up to ",Object(o.jsx)(St,{children:c})]})," ","for this character."]}),Object(o.jsx)("div",{children:"Replacing items which are below your current overall power can increase your power to a higher average."}),h&&h!==b&&Object(o.jsxs)("div",{children:["You need an extra"," ",Object(o.jsx)(St,{children:h})," total power on your items to reach an overall power of"," ",Object(o.jsx)(St,{children:Math.floor(p+1)}),"."]}),b&&Object(o.jsxs)("div",{children:["You need an extra"," ",Object(o.jsx)(St,{children:b})," total power on your items to reach an overall power of"," ",Object(o.jsx)(St,{children:c}),"."]})]})})]}),c===p&&p>=it&&p<st&&Object(o.jsxs)("div",{className:O()(Nt.a.hint,Nt.a.dropHint,Nt.a.powerfulHint),children:[Object(o.jsxs)("span",{children:["Powerful rewards can increase your overall gear power up to the powerful cap of ",Object(o.jsx)(St,{children:st})]}),Object(o.jsx)("div",{className:Nt.a.hintExtra,children:Object(o.jsxs)("div",{className:Nt.a.hintExtraInner,children:[Object(o.jsxs)("div",{children:["Powerful and pinnacle reward sources (Weekly challenges, Year 4 raids) will give you items above your overall gear power, with powerful rewards capped at"," ",Object(o.jsx)(St,{children:st}),"."]}),h&&Object(o.jsxs)("div",{children:["You need an extra ",Object(o.jsx)(St,{children:h})," ","total power on your items to reach an overall power of"," ",Object(o.jsx)(St,{children:Math.floor(p+1)}),"."]}),Object(o.jsx)("div",{children:"After getting a powerful reward, check back here to see if it's beneficial to catch up the rest of your slots with world drops before getting another!"})]})})]}),c===p&&p>=st&&p<ot&&Object(o.jsxs)("div",{className:O()(Nt.a.hint,Nt.a.dropHint,Nt.a.pinnacleHint),children:[Object(o.jsxs)("span",{children:["Pinnacle rewards can increase your overall gear power up to the pinnacle cap of ",Object(o.jsx)(St,{children:ot})]}),Object(o.jsx)("div",{className:Nt.a.hintExtra,children:Object(o.jsxs)("div",{className:Nt.a.hintExtraInner,children:[Object(o.jsxs)("div",{children:["Pinnacle reward sources (Some weekly challenges, Year 4 raids) will give you items at ",m," power."]}),h&&Object(o.jsxs)("div",{children:["You need an extra ",Object(o.jsx)(St,{children:h})," ","total power on your items to reach an overall power of"," ",Object(o.jsx)(St,{children:Math.floor(p+1)}),"."]})]})})]}),a&&a>t?Object(o.jsxs)("label",{className:Nt.a.testCheckbox,children:["Include multiple exotics",Object(o.jsx)("input",{type:"checkbox",checked:s,onClick:function(){return u(!s)}}),Object(o.jsx)("span",{className:Nt.a.switch})]}):null]})},Dt={red:0,green:0,blue:0},Tt={red:0,green:4,blue:15},Pt=function(e){var t,a=e.data,n=e.onDragStart,c=e.onDragEnd,i=e.onDragDrop,s=function(e){var t=Object(l.useRef)(null);return[t,function(){var a=Object(j.a)(f.a.mark((function a(){var n,c,i,s;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.current){a.next=18;break}return a.prev=1,a.next=4,r.e(0).then(r.t.bind(null,206,7));case 4:return n=a.sent,a.next=7,r.e(1).then(r.t.bind(null,207,7));case 7:return c=a.sent,i=c.saveAs,a.next=11,n.toBlob(t.current);case 11:s=a.sent,i(s,"destiny-power-bars-".concat(e,".png")),a.next=18;break;case 15:a.prev=15,a.t0=a.catch(1),console.error("Error capturing image of character display",a.t0);case 18:case"end":return a.stop()}}),a,null,[[1,15]])})));return function(){return a.apply(this,arguments)}}()]}(a.className),u=Object(p.a)(s,2),d=u[0],b=u[1],m=Object(l.useState)(!0),v=Object(p.a)(m,2),_=v[0],g=v[1],x=_&&a.unrestrictedOverallPower?a.unrestrictedOverallPower:a.overallPower,w=a.artifactData?a.artifactData.bonusPower:0;return function(e,t,r,a,n,c){var i,s=Object(l.useState)(!1),u=Object(p.a)(s,2),d=u[0],b=u[1],m=Object(l.useState)(0),f=Object(p.a)(m,2),j=f[0],v=f[1];return Object(o.jsxs)("div",{className:O()(Fe.a.characterDisplayWrapper,(i={},Object(h.a)(i,Fe.a.dragging,d),Object(h.a)(i,Fe.a.dragOver,j>0),i)),style:{backgroundColor:e},onDragStart:function(){b(!0),null===a||void 0===a||a()},onDragEnd:function(){b(!1),null===n||void 0===n||n()},onDragEnter:function(){return v(j+1)},onDragOver:function(e){e.stopPropagation(),e.preventDefault()},onDragLeave:function(){return v(Math.max(j-1,0))},onDrop:function(){v(0),null===c||void 0===c||c()},draggable:!0,ref:r,children:[t,Object(o.jsx)("div",{className:Fe.a.dragOverlay,children:Object(o.jsx)("span",{children:"Drag to reorder"})})]})}(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dt,t=e.red,r=e.green,a=e.blue;return"rgb(".concat(t,",").concat(r,",").concat(a,")")}(a.character.emblemColor||Tt),Object(o.jsxs)("div",{className:Fe.a.characterDisplay,children:[Object(o.jsxs)("div",{className:Fe.a.header,children:[Object(o.jsx)("img",{className:Fe.a.emblemBackground,src:"https://www.bungie.net".concat(a.character.emblemBackgroundPath||"/common/destiny2_content/icons/9dc4f3283ee9f9fc3d3499e9f9f1756c.jpg"),alt:""}),Object(o.jsx)("div",{className:O()(Fe.a.name,Object(h.a)({},Fe.a.withTitle,!!a.title)),children:(t=a.className,t.substr(0,1).toUpperCase()+t.substr(1))}),a.title&&Object(o.jsx)("div",{className:Fe.a.title,children:a.title}),Object(o.jsx)("div",{className:O()(Fe.a.power,Object(h.a)({},Fe.a.hasRedacted,!!a.hasRedactedEquippableItems)),children:x+w}),Object(o.jsx)("div",{className:Fe.a.headerOverlayBar})]}),Object(o.jsxs)("div",{className:Fe.a.content,children:[Object(o.jsx)(It,Object(S.a)(Object(S.a)({},a),{},{useUnrestrictedPower:_})),Object(o.jsx)(ft,Object(S.a)(Object(S.a)({},a),{},{useUnrestrictedPower:_})),Object(o.jsx)(kt,Object(S.a)(Object(S.a)({},a),{},{useUnrestrictedPower:_,onChangeUseUnrestrictedPower:function(e){return g(e)}}))]}),Object(o.jsx)(ze,{membershipType:a.character.membershipType,membershipId:a.character.membershipId,characterId:a.character.characterId,onImageExportClick:b})]}),d,n,c,i)},Ct=r(34),Rt=r.n(Ct),Mt=function(){return Object(o.jsx)("div",{className:Rt.a.fetchSpinnerContainer,children:Object(o.jsxs)("div",{className:Rt.a.anchor,children:[Object(o.jsx)("div",{className:Rt.a.spinner}),Object(o.jsx)("div",{className:Rt.a.spinnerSmall})]})})},Bt=r(90),Ht=r.n(Bt),Lt="acea3b8c34aa4b202ed41e4607c024a72290da8e".substr(0,6),Ft=function(){return Object(o.jsxs)("div",{className:Ht.a.buildStamp,children:[Lt," ","2020-11-27T09:29:03.396Z"]})},Ut=r(58),Gt=r.n(Ut),Wt=function(){return Object(o.jsx)("div",{className:Gt.a.kofiContainer,children:Object(o.jsxs)("a",{className:Gt.a.link,href:"https://ko-fi.com/tomcorke",target:"_blank",rel:"noopener",children:[Object(o.jsx)("img",{height:"36",style:{border:"0px",height:"36px"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAEM0lEQVRoge2Y229VRRSHv93L4VJ6oU14EKHIi4ARY9BEE5UaNZJqMFGQgDEaX0xINMbwAl4QgprGa+R/IAjBoFgJD0ZFE5sAiShYwVqxobGFtmBbyDltT8csZzeHszv7dPalCjJfstPT2WvPzG/WzFozg8PhcDgcDofD4XA4HI7/P56NQqXUSmAXUA5c/g9HpQwYAXqB34BDwCdAzmTseVbyJqOU+l5dveSUUluUUgSfsBGzoS7eUP0rZIA3gU6gcaoGbQVfC9wEnAKWXS+ChRlAKzArzMBWcMzVnyptwG5gP3BMQktI5YuAlkQNK6U6rUJWPq/UxYtKDQ2VthOb7m6lstkokfC+QFBaqJT6LsR2VN6btFSk5oK9e+CrL2F4GMrKYG49NDXBo6uhvFzbHD0C+/ZCVxfkx2B2FdxxJzz9DFRXT9VCcJZ1AfcAe4C1Bl1rgPenqsSIeNgPCma2vwH798EN87UISQki/MIA3HU3vL4NDh2EnR/B7FlQ36AHJZeD7rOw7Bb4cCfUlUwGTcA3hvJGPyeXB8oPep7XnL7g1gOwbSssWapFTOQ/Sfry9PXpv7Lkqmsgk4Hx8cL34v2TJ/RMeG1rHMH/iANWBcpOeZ63JGiYPEq3tUFNTbFY0L9FWEMDVFVBbR1UVhaLFfJ5WNgIP5+E/v64vfjTUFZvMkwueCQHM2cWi70SKRevBgfkSmZk4PIl6DsftxcZQ5kxPiUXPGcOZLP+tI3JqB/A5hqdYsOkqQtcMH2XXPCtyyGbiy9YPC/rfMECmDcvTg23AysM5WeMzcVpoYhVzbCoEXp7CunHFhkkmR2yLB5fE7cHH4SUy0lqEraCR0PfyPrd+IJOQ4OD2mM2iFgJWL93wrPP6fRVmmAAkKxxFFhp+CoPfGyqzTYttYeskwKfH4C3d8D8G3VUDkbjolY9/f70aXhyHby8yaYbXwA/SdQAbgYeLGH7HrDJdB5OT7Dw2afQ8pbegMjOSTw4qUXfsx2/wlprsVGQQVlOyAVAeltLYfVjUFGhPS0erK0tFj39Ys8CD5UySP942PwIbN8B/X0wMFAIZLK2x0a12PVPTYfYr/1Z2FvKaHrOw/c/AC3vwtAQ9PTojYdE444OHaBefCnN1mQf/YS0Clyayth2DR+fWBeRaG+HVzdr0ZUV8PxGWL8hrjCJI8O+qG7gFz/1HAkVl+AS73jsK7w/zii1YZ1Su3fFrsJnsemirtRjHARLwT8At8UbLsniI3otl0XcmBSQa1g50J+L8lGSKD0cqXtBKk17+0iciCo2DNug9WMajSWgNa2KbKf0vcDhaRBiQ4+/sxqM+qFpStt6+FvglRQ6H5W/gIfjiA3D1sMTP2WjvgVY6h+6x/w68v4TrE/+H/cPH6a2xgxlnp965Dr2HSAbW1ySM7rD4XA4HA6Hw+FwXD8AfwPHcRHtjfBbbgAAAABJRU5ErkJggg==",alt:"Buy Me a Coffee at ko-fi.com"}),Object(o.jsx)("span",{children:"Buy me a coffee"})]})})};function Vt(){return(Vt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function zt(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},c=Object.keys(e);for(a=0;a<c.length;a++)r=c[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var qt=l.createElement("path",{d:"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"});function Jt(e,t){var r=e.title,a=e.titleId,n=zt(e,["title","titleId"]);return l.createElement("svg",Vt({role:"img",viewBox:"0 0 24 24",ref:t,"aria-labelledby":a},n),void 0===r?l.createElement("title",{id:a},"GitHub icon"):r?l.createElement("title",{id:a},r):null,qt)}var Yt=l.forwardRef(Jt);r.p;function Kt(){return(Kt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Qt(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},c=Object.keys(e);for(a=0;a<c.length;a++)r=c[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var Zt=l.createElement("path",{d:"M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"});function Xt(e,t){var r=e.title,a=e.titleId,n=Qt(e,["title","titleId"]);return l.createElement("svg",Kt({role:"img",viewBox:"0 0 24 24",ref:t,"aria-labelledby":a},n),void 0===r?l.createElement("title",{id:a},"Twitter icon"):r?l.createElement("title",{id:a},r):null,Zt)}var $t,er,tr,rr,ar,nr,cr,ir,sr=l.forwardRef(Xt),or=(r.p,r(35)),lr=r.n(or),ur=function(){return Object(o.jsxs)("div",{className:lr.a.socialLinks,children:[Object(o.jsx)("div",{className:lr.a.link,children:Object(o.jsx)(Wt,{})}),Object(o.jsx)("a",{className:lr.a.link,href:"https://www.twitter.com/corke_tom",target:"_blank",rel:"noreferrer noopener",children:Object(o.jsx)(sr,{width:20,height:20,style:{fill:"rgba(255,255,255,0.8)"}})}),Object(o.jsx)("a",{className:lr.a.link,href:"https://github.com/tomcorke/destiny-power-bars",target:"_blank",rel:"noreferrer noopener",children:Object(o.jsx)(Yt,{width:20,height:20,style:{fill:"rgba(255,255,255,0.8)"}})})]})},dr=r(59),pr=r.n(dr),hr=function(){return Object(o.jsxs)("div",{className:pr.a.footer,children:[Object(o.jsx)("div",{className:pr.a.copy,children:"Destiny Power Bars \xa9 Tom Corke."}),Object(o.jsx)(ur,{}),Object(o.jsx)(Ft,{})]})},br=r(36),mr=r.n(br),fr=function(){return Object(o.jsxs)("div",{className:mr.a.headerContainer,children:[Object(o.jsx)("div",{className:mr.a.header,children:"Destiny Power Bars"}),Object(o.jsxs)("div",{className:mr.a.subHeader,children:["by"," ",Object(o.jsx)("a",{className:mr.a.author,href:"https://twitter.com/corke_tom",rel:"noreferrer noopener",target:"_blank",children:"Tom Corke"})]})]})},jr=r(26),vr=r.n(jr),_r=function(e){var t=e.items,r=e.withTopMargin;return Object(o.jsx)("div",{className:O()(vr.a.LoadingChecklist,Object(h.a)({},vr.a.topMargin,r)),children:Object(o.jsx)("ul",{children:t.map((function(e){return Object(o.jsx)("li",{children:Object(o.jsxs)("div",{className:vr.a.item,children:[Object(o.jsx)("div",{className:O()(vr.a.status,vr.a[e.status])}),e.label]})},e.label)}))})})},Or=r(20),gr=r.n(Or),xr=function(e){var t=e.children;return Object(o.jsxs)("div",{className:gr.a.loading,children:[Object(o.jsxs)("div",{className:gr.a.anchor,children:[Object(o.jsx)("div",{className:gr.a.spinnerLarge}),Object(o.jsx)("div",{className:gr.a.spinnerLargeDouble}),Object(o.jsx)("div",{className:gr.a.spinnerSmall}),Object(o.jsx)("div",{className:gr.a.spinnerSmallDouble})]}),Object(o.jsx)("div",{className:gr.a.status,children:t})]})},wr=r(27),yr=r.n(wr),Sr=function(e){var t,r,a=e.lowResImage,n=e.highResImage,c=e.alt,i=void 0===c?"":c,s=Object(l.useState)(!1),u=Object(p.a)(s,2),d=u[0],b=u[1],m=Object(l.useCallback)((function(){b(!0)}),[b]);return Object(o.jsxs)("div",{className:yr.a.lazyImage,children:[Object(o.jsx)("img",{src:n,alt:i,className:O()((t={},Object(h.a)(t,yr.a.hidden,!d),Object(h.a)(t,yr.a.overlay,!d),t)),onLoad:m}),Object(o.jsx)("img",{src:a,alt:i,className:O()((r={},Object(h.a)(r,yr.a.hidden,d),Object(h.a)(r,yr.a.overlay,d),r))})]})},Ar=r.p+"static/media/example-titan-character-display-with-info-blur.cbe18dfa.jpg",Ir=r.p+"static/media/example-titan-character-display-with-info.2daef1c3.png",Er=r(37),Nr=r.n(Er),kr=function(){return we()},Dr=function(e){var t=e.onLoginClick,r=void 0===t?kr:t;return Object(o.jsxs)("div",{className:Nr.a.loginContainer,children:[Object(o.jsx)("div",{className:Nr.a.exampleImage,children:Object(o.jsx)(Sr,{lowResImage:Ar,highResImage:Ir,alt:"Example Destiny Power Bars"})}),Object(o.jsxs)("div",{className:Nr.a.login,children:[Object(o.jsx)("div",{children:"Destiny Power Bars requires access to your inventory and vault to determine your maximum power per slot and character. Please log in to Bungie.net to authorize this application."}),Object(o.jsx)("button",{className:Nr.a.loginButton,onClick:r,children:"Log in with Bungie.net"})]})]})},Tr=r(12),Pr=r.n(Tr),Cr={1:"xbox",2:"psn",3:"steam",4:"blizzard",5:"stadia"},Rr=function(e){return e.crossSaveOverride&&e.crossSaveOverride===e.membershipType},Mr=function(e){return e.crossSaveOverride&&e.crossSaveOverride!==e.membershipType},Br=function(e){var t=e.membership;return 0===t.applicableMembershipTypes.length?null:Object(o.jsx)("div",{className:Pr.a.crossSaveDisplayWrapper,children:Object(o.jsxs)("div",{className:Pr.a.crossSaveDisplay,title:"Cross-save enabled for: ".concat(t.applicableMembershipTypes.map((function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.substr(0,1).toUpperCase()+e.substr(1)}(Cr[e])})).join(", ")),children:[Object(o.jsx)("div",{className:Pr.a.crossSaveIcon}),t.applicableMembershipTypes.map((function(e){return Object(o.jsx)("div",{className:O()(Pr.a.crossSaveMembershipIcon,Pr.a["crossSaveMembershipType_".concat(Cr[e])])},e)}))]})})},Hr=function(e){var t=e.onMembershipSelect,r=e.api.bungieAuth.getDestinyMemberships();return r?0===r.length?Object(o.jsx)("div",{children:"No destiny memberships!"}):Object(o.jsx)("div",{className:Pr.a.membershipSelect,children:r.filter((function(e){return!Mr(e)})).filter((function(e){return 4!==e.membershipType})).map((function(e){var r;return Object(o.jsxs)("div",{className:O()(Pr.a.membership,Pr.a["platform_".concat(Cr[e.membershipType])],(r={},Object(h.a)(r,Pr.a.crossSaveActive,Rr(e)),Object(h.a)(r,Pr.a.crossSaveDisabled,Mr(e)),r)),onClick:function(){return t(e)},children:[Object(o.jsx)("span",{className:Pr.a.membershipDisplayName,children:e.displayName}),Rr(e)?Object(o.jsx)(Br,{membership:e}):null]},e.membershipId)}))}):null},Lr=r(91),Fr=r.n(Lr),Ur=r(60),Gr=r.n(Ur),Wr=r(61),Vr=r.n(Wr),zr=r(49),qr=r.n(zr),Jr=r(92),Yr=r.n(Jr),Kr="characterDisplayOrder",Qr="cachedCharacterData",Zr=function(){var e=localStorage.getItem(Kr);try{return e?JSON.parse(e):void 0}catch(t){return}},Xr=function(e){localStorage.setItem(Kr,JSON.stringify(e))},$r=function(e){return Vr()(e,(function(e){var t,r;return(null===e||void 0===e||null===(t=e.instanceData)||void 0===t||null===(r=t.primaryStat)||void 0===r?void 0:r.value)||0}))},ea=function(e){return Object.values(e).reduce((function(e,t){return e+t}),0)/Object.keys(et).length},ta=function(e){return Math.floor(ea(e))},ra=function(e){var t=$r(e);return{averagePower:ea(t),overallPower:ta(t)}},aa=function(e){return Object.values(e).reduce((function(e,t){return e.concat(t.items)}),[])},na=function(e,t,r,a){return e.map((function(e){var a=e.itemInstanceId?r[e.itemInstanceId]:void 0,n=t.DestinyInventoryItemDefinition[e.itemHash];return Object(S.a)(Object(S.a)({},e),{},{instanceData:a,itemDefinition:n})})).filter((function(e){return e.instanceData&&e.itemDefinition&&[at,nt].includes(e.itemDefinition.itemType)})).map((function(e){return Object(S.a)(Object(S.a)({},e),{},{instanceData:e.instanceData,itemDefinition:e.itemDefinition})})).map((function(e){return Object(S.a)(Object(S.a)({},e),{},{slotName:tt[e.itemDefinition.inventory.bucketTypeHash]})})).filter((function(e){return e.instanceData.primaryStat&&e.instanceData.primaryStat.value})).filter((function(e){return function(e,t){return!!e.instanceData&&!(e.instanceData.equipRequiredLevel>t.baseCharacterLevel)&&(3===e.itemDefinition.classType||e.itemDefinition.classType===t.classType)&&(16===e.instanceData.cannotEquipReason||e.instanceData.canEquip,!0)}(e,a)}))},ca=function(e,t){if(!e||!e.instanceData||!e.instanceData.primaryStat)return 0;var r=e.instanceData.primaryStat.value;return t&&t.some((function(t){return t.itemInstanceId===e.itemInstanceId}))&&(r+=.5),lt(e)&&(r+=.25),1===e.location&&(r+=.125),r},ia=function(e){var t;return null===e||void 0===e||null===(t=e.itemDefinition.equippingBlock)||void 0===t?void 0:t.uniqueLabel},sa=function(e,t,r,a,n,c,i,s){var o=t[e],l=ct[o.classType],u=na(c,a,r,o),d=na(i.items,a,r,o).filter((function(e){return 3===e.itemDefinition.classType||e.itemDefinition.classType===o.classType})),p=c.some((function(e){var t=a.DestinyInventoryItemDefinition[e.itemHash];return(null===t||void 0===t?void 0:t.redacted)&&(null===t||void 0===t?void 0:t.equippable)})),h=u.concat(d),b=Gr()(h,(function(e){return e.slotName})),m=Vr()(b,(function(e){return qr()(e,(function(e){return ca(e,n)}))})),f=m,j=Gr()(Object.values(m).filter(ia),ia);Fr()(j,(function(e){if(!(e.length<=1)){var t=[];e.forEach((function(r){var a=e.filter((function(e){return e!==r})).filter((function(e){return!!e})).map((function(e){return e})),c=!0,i=Object(S.a)({},m);a.forEach((function(e){var t=b[e.slotName].filter((function(e){return!ia(e)}));t.length>0?i[e.slotName]=qr()(t,(function(e){return ca(e,n)})):c=!1})),c&&t.push(i)}));if(t.length>0){var r=qr()(t,(function(e){return Yr()(Object.values(e),ca)}));m=r}}}));Object.values(m).forEach((function(e){e&&215593132===e.bucketHash&&(e.location=4)}));var v,_=$r(f),O=ra(m),g=O.averagePower,x=O.overallPower,w=ra(f),y=w.averagePower,A=w.overallPower,I=c.find((function(e){return 1506418338===e.bucketHash})),E=(null===I||void 0===I?void 0:I.itemInstanceId)&&r[I.itemInstanceId];if(I&&s.seasonalArtifact&&E){var N,k,D,T,P,C,R=a.DestinyInventoryItemDefinition[I.itemHash];v={bonusPower:s.seasonalArtifact.powerBonus||E.primaryStat.value,iconPath:null===(N=R.displayProperties)||void 0===N?void 0:N.icon,name:(null===(k=R.displayProperties)||void 0===k?void 0:k.name)||"Artifact",progressToNextLevel:null===(D=s.seasonalArtifact)||void 0===D||null===(T=D.powerBonusProgression)||void 0===T?void 0:T.progressToNextLevel,nextLevelAt:null===(P=s.seasonalArtifact)||void 0===P||null===(C=P.powerBonusProgression)||void 0===C?void 0:C.nextLevelAt}}for(var M=Object(S.a)({},_),B=function(){var e=ta(M);Object.keys(M).forEach((function(t){return M[t]=Math.max(it,Math.max(e,M[t]))}))};Object.values(M).some((function(e){return e<ta(M)||e<it}));)B();var H=ta(M),L=a.DestinyRecordDefinition[o.titleRecordHash||""],F=L&&L.titleInfo.titlesByGenderHash[o.genderHash];return{character:o,className:l,overallPower:x,overallPowerExact:g,topItemBySlot:m,unrestrictedOverallPower:A,unrestrictedOverallPowerExact:y,topUnrestrictedItemBySlot:f,potentialOverallPower:H,artifactData:v,title:F,hasRedactedEquippableItems:p}},oa=function(e){return function(e){var t=0;if(0===e.length)return t;for(var r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t&=t;return t}(JSON.stringify(e))},la=function(){var e=Object(j.a)(f.a.mark((function e(t){var r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=localStorage.getItem(Qr))try{a=JSON.parse(r),t(a)}catch(n){console.error("Error parsing cached character data",n)}case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ua=!1,da=function(){return ua},pa=function(){var e=Object(j.a)(f.a.mark((function e(t){var r,a,n,c,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.find((function(e){return e.topItemBySlot&&Object.values(e.topItemBySlot).find((function(e){return null===e||void 0===e?void 0:e.itemInstanceId}))})),(null===(n=Object.values(null!==(r=null===a||void 0===a?void 0:a.topItemBySlot)&&void 0!==r?r:{}).find((function(e){return null===e||void 0===e?void 0:e.itemInstanceId})))||void 0===n?void 0:n.itemInstanceId)&&a){e.next=4;break}return e.abrupt("return");case 4:return c=1===(n.state&&1&n.state),i={state:c,itemId:n.itemInstanceId,characterId:null===a||void 0===a?void 0:a.character.characterId,membershipType:null===a||void 0===a?void 0:a.character.membershipType},ua=!0,W.emit(F.FETCHING_CHARACTER_DATA_CHANGE),e.prev=8,e.next=11,oe(i);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(8),e.t0;case 16:return e.prev=16,ua=!1,W.emit(F.FETCHING_CHARACTER_DATA_CHANGE),e.finish(16);case 20:case"end":return e.stop()}}),e,null,[[8,13,16,20]])})));return function(t){return e.apply(this,arguments)}}(),ha=function(){var e=Object(j.a)(f.a.mark((function e(t){var r,a,n,c,i,s,o,l,u,d,p,h,b,m,j,v,_,O,g,x,w,y,S,A,I,E,N,k,D,T,P,C,R,M,B,H;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,Be();case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:if(x=ce(),ua=!0,W.emit(F.FETCHING_CHARACTER_DATA_CHANGE),w=Ce()){e.next=13;break}return e.abrupt("return");case 13:return e.prev=13,e.next=16,se(w.membershipType,w.membershipId);case 16:if("SystemDisabled"!==(y=e.sent).ErrorStatus){e.next=19;break}throw new Q;case 19:e.next=32;break;case 21:if(e.prev=21,e.t0=e.catch(13),"401"!==e.t0.message){e.next=31;break}return e.next=26,Be();case 26:return e.next=28,se(w.membershipType,w.membershipId);case 28:y=e.sent,e.next=32;break;case 31:throw e.t0;case 32:if(y&&(null===(r=y)||void 0===r||null===(a=r.Response)||void 0===a||null===(n=a.characters)||void 0===n?void 0:n.data)&&(null===(c=y)||void 0===c||null===(i=c.Response)||void 0===i||null===(s=i.characterEquipment)||void 0===s?void 0:s.data)&&(null===(o=y)||void 0===o||null===(l=o.Response)||void 0===l||null===(u=l.characterInventories)||void 0===u?void 0:u.data)&&(null===(d=y)||void 0===d||null===(p=d.Response)||void 0===p||null===(h=p.profileInventory)||void 0===h?void 0:h.data)&&(null===(b=y)||void 0===b||null===(m=b.Response)||void 0===m||null===(j=m.itemComponents)||void 0===j||null===(v=j.instances)||void 0===v?void 0:v.data)&&(null===(_=y)||void 0===_||null===(O=_.Response)||void 0===O||null===(g=O.profileProgression)||void 0===g?void 0:g.data)){e.next=34;break}return e.abrupt("return");case 34:return S=y.Response.characters.data,A=y.Response.characterEquipment.data,I=y.Response.characterInventories.data,E=y.Response.profileInventory.data,N=y.Response.itemComponents.instances.data,k=y.Response.profileProgression.data,e.prev=40,e.next=43,x;case 43:D=e.sent,e.next=50;break;case 46:return e.prev=46,e.t1=e.catch(40),console.error(e.t1),e.abrupt("return");case 50:if(D&&D.manifest){e.next=52;break}return e.abrupt("return");case 52:if(T=D.manifest,P=aa(I).concat(aa(A)).concat(E.items),C=oa(P),R=oa(N),M=oa(k),C!==er||D!==$t||R!==tr||M!==rr||!ar){e.next=61;break}return e.abrupt("return",ar);case 61:$t=D,er=C,tr=R,rr=M,B=Object.keys(S),H=B.map((function(e){return sa(e,S,N,T,A[e].items,P,E,k)})),ar=H,f=H,localStorage.setItem(Qr,JSON.stringify(f)),t(H),e.next=75;break;case 72:throw e.prev=72,e.t2=e.catch(1),e.t2;case 75:return e.prev=75,ua=!1,W.emit(F.FETCHING_CHARACTER_DATA_CHANGE),e.finish(75);case 79:case"end":return e.stop()}var f}),e,null,[[1,72,75,79],[13,21],[40,46]])})));return function(t){return e.apply(this,arguments)}}(),ba="0",ma="1",fa="2",ja={devrim:"Devrim Kay (EDZ)",sloane:"Sloane (Titan)",failsafe:"Failsafe (Nessus)",asher:"Asher Mir (Io)",zavala:"Zavala (Vanguard, Tower)",shaxx:"Shaxx (Crucible, Tower)",banshee:"Banshee-44 (Gunsmith, Tower)",fanboy:"Brother Vance (Mercury)",bray:"Ana Bray (Mars)",werner:"Werner 99-40 (Tower, Nessus Barge)"},va=function(e){return ja[e]||e},_a=function(){var e=Object(j.a)(f.a.mark((function e(){var t,r,a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.vendorengrams.xyz/getVendorDrops?source=destiny-power-bars");case 2:return t=e.sent,e.next=5,t.json();case 5:return r=e.sent,a=Date.now(),nr=n={data:r,updateTimestamp:a},e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Oa=function(){var e=Object(j.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!nr){e.next=2;break}return e.abrupt("return",nr);case 2:return ir||(ir=_a()),cr||(cr=setInterval((function(){_a().catch((function(e){return console.warn("Error refreshing vendorengrams.xyz data",e)}))}),3e5)),e.abrupt("return",ir);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ga={bungieApi:n,bungieAuth:c,ga:a,utils:i,vendors:s},xa=r(62),wa=r.n(xa),ya=function(){var e=Object(l.useState)(!1),t=Object(p.a)(e,2),r=t[0],a=t[1],n=Object(l.useState)(!1),c=Object(p.a)(n,2),i=c[0],s=c[1];if(i)return null;var u=Object(o.jsx)("button",{onClick:function(){return a(!0)},children:"(more details)"}),d=Object(o.jsx)("button",{onClick:function(){return a(!1)},children:"(less details)"}),h=Object(o.jsx)("button",{onClick:function(){return s(!0)},children:"(hide)"}),b=r?Object(o.jsxs)("div",{children:[Object(o.jsx)("p",{children:"Redacted equippable items were found in your character or account inventories."}),Object(o.jsx)("p",{children:"Redacted items do not display their power level or item type in the data returned by the API, so we can not use them to calculate your character's maximum equippable power."}),Object(o.jsx)("p",{children:"These items are usually found within recently added content (raids, dungeons) and will be un-redacted soon by Bungie, usually at the next weekly reset."}),Object(o.jsx)("p",{children:"There is nothing we can do to make this data visible quicker, sorry!"}),Object(o.jsxs)("p",{children:['If you believe this to be an error (or your data seems "stuck"), you can try deleting and re-downloading your cached Destiny manifest by'," ",Object(o.jsx)("button",{onClick:function(){return ne()},children:"clicking here to clear it"}),"."]}),Object(o.jsxs)("div",{className:wa.a.links,children:[d,h]})]}):Object(o.jsxs)(o.Fragment,{children:["Redacted items detected, maximum power displayed might not be accurate!"," ",u]});return Object(o.jsx)("div",{className:wa.a.redactedWarning,children:b})},Sa=(r(199),r(200),r(24)),Aa=r.n(Sa),Ia=r(96),Ea=r(14),Na=r.n(Ea),ka=function(){return He()},Da=function(e){var t=e.isFetchingCharacterData,r=e.onRefreshClick,a=e.onLogout,n=void 0===a?ka:a,c=Object(Ia.a)(e,["isFetchingCharacterData","onRefreshClick","onLogout"]);return Object(o.jsxs)("div",{className:Na.a.membershipHeader,children:[Object(o.jsxs)("button",{className:O()(Na.a.hardRefreshButton,Object(h.a)({},Na.a.disabled,t)),onClick:r,children:[Object(o.jsx)("div",{className:Na.a.hardRefreshIcon}),Object(o.jsx)("div",{className:Na.a.hardRefreshText,children:"Force Refresh"})]}),Object(o.jsx)("div",{className:Na.a.membershipSelect,children:Object(o.jsx)(Hr,Object(S.a)({},c))}),Object(o.jsxs)("button",{className:Na.a.logOutButton,onClick:function(){return n()},title:"Log out",children:[Object(o.jsx)("div",{className:Na.a.logOutIcon}),Object(o.jsx)("div",{className:Na.a.logOutText,children:"Log out"})]})]})},Ta=x()((function(e,t){Object(j.a)(f.a.mark((function r(){return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Be();case 3:r.sent?(e(!0),t(!1)):(e(!1),t(!0)),r.next=12;break;case 7:r.prev=7,r.t0=r.catch(0),console.error(r.t0),e(!1),t(!0);case 12:case"end":return r.stop()}}),r,null,[[0,7]])})))()}),100),Pa=x()((function(e,t,r){Object(j.a)(f.a.mark((function a(){var n;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,ce();case 3:if(!(n=a.sent).error){a.next=10;break}return console.error("Error fetching manifest:",n.error.message),r(!0),n.error instanceof Q&&e(!0),"503"===n.error.message&&t(!0),a.abrupt("return");case 10:a.next=16;break;case 12:a.prev=12,a.t0=a.catch(0),console.error(a.t0),r(!0);case 16:case"end":return a.stop()}}),a,null,[[0,12]])})))()}),500),Ca=x()((function(e,t,r){var a=function(t){var r=Math.max.apply(Math,Object(b.a)(t.map((function(e){return e.overallPower})))),a=Math.max.apply(Math,Object(b.a)(t.map((function(e){return e.artifactData?e.artifactData.bonusPower:0})))),n=r+a;K.set({dimension1:"".concat(r),dimension2:"".concat(a),dimension3:"".concat(n)}),e(t)},n=da();Object(j.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,ha(a);case 5:e.next=12;break;case 7:e.prev=7,e.t0=e.catch(2),e.t0 instanceof Q&&t(!0),"503"===e.t0.message&&r(!0),console.error("Error fetching character data:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,7]])})))()}),500),Ra=x()(function(){var e=Object(j.a)(f.a.mark((function e(t,r,a,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=9;break}return e.prev=1,e.next=4,pa(n);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error("Error busting profile cache, but silently ignoring",e.t0);case 9:return e.abrupt("return",Ca(t,r,a));case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,r,a,n){return e.apply(this,arguments)}}(),500),Ma=function(e){var t=e.children,r=e.top,a=void 0!==r&&r;return Object(o.jsx)("div",{className:Aa.a.App,children:Object(o.jsx)("div",{className:O()(Aa.a.AppInner,Object(h.a)({},Aa.a.top,a)),children:t})})},Ba=function(){var e=Object(l.useState)(_e()),t=Object(p.a)(e,2),r=t[0],a=t[1],n=Object(l.useState)(De()),c=Object(p.a)(n,2),i=c[0],s=c[1],u=Object(l.useState)(!1),d=Object(p.a)(u,2),h=d[0],b=d[1],m=Object(l.useState)(!1),f=Object(p.a)(m,2),j=f[0],_=f[1],O=Object(l.useState)(!1),g=Object(p.a)(O,2),x=g[0],w=g[1],y=Object(l.useState)(!1),S=Object(p.a)(y,2),A=S[0],I=S[1],E=Object(l.useState)(da()),N=Object(p.a)(E,2),k=N[0],D=N[1];V(F.FETCHING_CHARACTER_DATA_CHANGE,(function(){return D(da())}));var T=Object(l.useState)(void 0),P=Object(p.a)(T,2),C=P[0],R=P[1],M=Object(l.useState)("Initialising..."),B=Object(p.a)(M,2),H=B[0],L=B[1];V(F.GET_MANIFEST,(function(){_(!1),L("Checking manifest version")})),V(F.LOAD_MANIFEST_DATA,(function(){return L("Loading manifest data")})),V(F.FETCH_MANIFEST_DATA,(function(){return L("Fetching manifest data from Bungie")})),V(F.PARSE_MANIFEST_DATA,(function(){return L("Processing manifest data")})),V(F.STORE_MANIFEST_DATA,(function(){return L("Saving manifest data")})),V(F.MANIFEST_DATA_READY,(function(){_(!1),L("Manifest ready")})),V(F.LOG_OUT,(function(){s(!1),a(!1)}));var U="Manifest ready"===H;Object(l.useEffect)((function(){i||Ta(s,b)}),[i,s,b]),Object(l.useEffect)((function(){return Pa(w,I,_)}),[w,I,_]),V(F.MANIFEST_FETCH_ERROR,(function(){Pa(w,I,_)}));var G=Object(l.useState)(!1),W=Object(p.a)(G,2),z=W[0],q=W[1],J=Re();Object(l.useEffect)((function(){i&&J&&!z&&(q(!0),la(R))}),[i,J,z,q]),Object(v.a)((function(){i&&J&&!k&&Ca(R,w,I)}),15e3),Object(l.useEffect)((function(){!i||C||k||x||Ca(R,w,I)}),[i,C,k,x]);var Y=Object(l.useCallback)((function(e){K.event({category:"Platform",action:"Select platform",label:"Membership type: ".concat(e.membershipType)}),Me(e)}),[]),Q="";x?Q=Object(o.jsxs)("span",{children:["Bungie API disabled.",Object(o.jsx)("br",{}),"Check"," ",Object(o.jsx)("a",{href:"https://www.bungie.net/en/Help/Article/13125",target:"_blank",rel:"noopener noreferrer",children:"Bungie's server and update status page"})," ","for more information"]}):A?Q=Object(o.jsxs)("span",{children:["Bungie API unavailable.",Object(o.jsx)("br",{}),"Check"," ",Object(o.jsx)("a",{href:"https://www.bungie.net/en/Help/Article/13125",target:"_blank",rel:"noopener noreferrer",children:"Bungie's server and update status page"})," ","for more information"]}):h?Q=Object(o.jsx)("span",{className:Aa.a.statusAuthError,onClick:function(){return we()},children:"Bungie.net authentication required"}):j?Q=Object(o.jsxs)("span",{children:["Error loading manifest, if this persists try"," ",Object(o.jsx)("a",{href:"/",children:"refreshing the page"}),"!"]}):i?J?U?C&&0!==C.length||(Q=k?"Fetching character data...":"No character data"):Q=H:Q="Waiting for Destiny platform selection...":Q="Authenticating...",window.characterData=C;var Z=Object(l.useCallback)((function(){return C?C.map((function(e){return e.character.characterId})):[]}),[C]),X=Object(l.useCallback)((function(e){return C&&C.length===e.length&&e.every((function(e){return C.some((function(t){return t.character.characterId===e}))}))&&C.every((function(t){return e.includes(t.character.characterId)}))}),[C]),$=Object(l.useState)(void 0),ee=Object(p.a)($,2),te=ee[0],re=ee[1],ae=Object(l.useState)(Zr()),ne=Object(p.a)(ae,2),ce=ne[0],ie=ne[1],se=Object(l.useCallback)((function(e){if(te&&te!==e){var t=ce&&ce.length>0?ce:Z(),r=t.slice();r.splice(t.indexOf(te),1,e),r.splice(t.indexOf(e),1,te),Xr(r),ie(r)}}),[te,ce,ie,Z]),oe=Z();if(C&&C.length>0&&ce&&ce.length>0&&(X(ce)?oe=ce:ie(void 0)),i&&C&&C.length>0){var le=C.some((function(e){return e.hasRedactedEquippableItems}));return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)(Ma,{top:!0,children:[Object(o.jsx)(Da,{api:ga,onMembershipSelect:Y,isFetchingCharacterData:k,onRefreshClick:function(){Ra(R,w,I,C)}}),Object(o.jsx)("div",{className:Aa.a.charactersContainer,children:Object(o.jsx)("div",{className:Aa.a.characters,children:oe.map((function(e){return C.find((function(t){return t.character.characterId===e}))})).map((function(e){return Object(o.jsx)(Pt,{data:e,onDragStart:function(){return re(e.character.characterId)},onDragEnd:function(){return re(void 0)},onDragDrop:function(){return se(e.character.characterId)}},e.character.characterId)}))})}),le?Object(o.jsx)(ya,{}):null,Q?Object(o.jsx)(xr,{children:Q}):null,k?Object(o.jsx)(Mt,{}):null]}),Object(o.jsx)(hr,{})]})}if(h&&!r)return Object(o.jsxs)(Ma,{children:[Object(o.jsx)(fr,{}),Object(o.jsx)(Dr,{}),Object(o.jsx)(hr,{})]});var ue=[],de=function(e,t,r){return ue.push({label:e,status:t?"complete":r?"failed":"pending"})};return de("Authenticated",i,h),de("Loaded Character Data",!!C),de("Loaded Destiny Manifest Defintions",U,j),Object(o.jsxs)(Ma,{children:[Object(o.jsx)(Hr,{api:ga,onMembershipSelect:Y}),Object(o.jsx)(_r,{withTopMargin:!0,items:ue}),Object(o.jsx)(xr,{children:Q}),Object(o.jsx)(hr,{})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));d.a.render(Object(o.jsx)(Ba,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},24:function(e,t,r){e.exports={App:"App_App__15LM-",AppInner:"App_AppInner__2tVOm",top:"App_top__3N23O",loadingContainer:"App_loadingContainer__1Pa9s",charactersContainer:"App_charactersContainer__1RSU_",characters:"App_characters__1GhrS",loadingStatus:"App_loadingStatus__3QEhd",statusAuthError:"App_statusAuthError__3mdh6",header:"App_header__2L3DO"}},26:function(e,t,r){e.exports={LoadingChecklist:"LoadingChecklist_LoadingChecklist__KbNL5",topMargin:"LoadingChecklist_topMargin__1ARfF",item:"LoadingChecklist_item__2_2Cl",status:"LoadingChecklist_status__1-PMx",complete:"LoadingChecklist_complete__1qfgG",pending:"LoadingChecklist_pending__3ykCd",failed:"LoadingChecklist_failed__2NRty"}},27:function(e,t,r){e.exports={lazyImage:"LazyImage_lazyImage__j4cxv",hidden:"LazyImage_hidden__sfsi5",overlay:"LazyImage_overlay__1Z9M2"}},34:function(e,t,r){e.exports={anchor:"FetchSpinner_anchor__2bpEe",spinner:"FetchSpinner_spinner__3uf-_",spin:"FetchSpinner_spin__3wMft",fetchSpinnerContainer:"FetchSpinner_fetchSpinnerContainer__2f9d4",spinnerSmall:"FetchSpinner_spinnerSmall__2pJsX"}},35:function(e,t,r){e.exports={socialLinks:"SocialLinks_socialLinks__18XFZ",link:"SocialLinks_link__3Z2Wj"}},36:function(e,t,r){e.exports={headerContainer:"Header_headerContainer__3M_mx",header:"Header_header__2XAj3",subHeader:"Header_subHeader__3Ap8f",author:"Header_author__17ihj"}},37:function(e,t,r){e.exports={loginContainer:"LoginPrompt_loginContainer__1DfGO",exampleImage:"LoginPrompt_exampleImage__3f80u",login:"LoginPrompt_login__r8eqR",loginButton:"LoginPrompt_loginButton__n1OHn"}},58:function(e,t,r){e.exports={kofiContainer:"KoFi_kofiContainer__1-NvR",link:"KoFi_link__mMabj"}},59:function(e,t,r){e.exports={footer:"Footer_footer__1G6Wy",copy:"Footer_copy__1vcN0"}},62:function(e,t,r){e.exports={redactedWarning:"RedactedWarning_redactedWarning__2FrKD",links:"RedactedWarning_links__17r-9"}},8:function(e,t,r){e.exports={hints:"PowerHints_hints__9HbgH",hint:"PowerHints_hint__2zx_C",dropHint:"PowerHints_dropHint__3lQ-N",worldDropHint:"PowerHints_worldDropHint__3M_Nv",legendaryWorldDropHint:"PowerHints_legendaryWorldDropHint__g_SSJ",powerfulHint:"PowerHints_powerfulHint__26w25",pinnacleHint:"PowerHints_pinnacleHint__c2cdM",separator:"PowerHints_separator__1_of2",hintExtra:"PowerHints_hintExtra__2TIGc",hintExtraInner:"PowerHints_hintExtraInner__2tEbw",testCheckbox:"PowerHints_testCheckbox__e9kFS",switch:"PowerHints_switch__3n4lW"}},89:function(e,t,r){e.exports={inlinePowerNumber:"Power_inlinePowerNumber__28Oqz"}},9:function(e,t,r){e.exports={barWrapper:"PowerBar_barWrapper__2Er15",generalLabel:"PowerBar_generalLabel__3N-0q",specificLabel:"PowerBar_specificLabel__3OkJr",iconWrapper:"PowerBar_iconWrapper__1k9U_",icon:"PowerBar_icon__3zN_u",barContainer:"PowerBar_barContainer__KfIri",barLine:"PowerBar_barLine__Fc3BR",filledBar:"PowerBar_filledBar__3a32S",label:"PowerBar_label__32eba",power:"PowerBar_power__2ZVuC",max:"PowerBar_max__L5cvP",belowAverage:"PowerBar_belowAverage__2r-Dj",vaultOverlay:"PowerBar_vaultOverlay__39TWm",postmasterOverlay:"PowerBar_postmasterOverlay__2Ir6r",masterworkOverlay:"PowerBar_masterworkOverlay__2DcIk"}},90:function(e,t,r){e.exports={buildStamp:"BuildStamp_buildStamp__16Chc"}}},[[201,3,4]]]);
//# sourceMappingURL=main.8a449e61.chunk.js.map